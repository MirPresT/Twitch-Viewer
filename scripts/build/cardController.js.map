{"version":3,"sources":["scripts/cardController.js"],"names":[],"mappings":"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","file":"scripts/cardController.js","sourcesContent":["(function() {\r\n\r\n    angular.module('myApp')\r\n        .controller('cardsCtrl', cardsCtrl);\r\n\r\n    function cardsCtrl($scope, getTwitchData, $http, $q, menuService) {\r\n\r\n        // seting variable to correct context of this\r\n        var vm = this;\r\n        // array for each card object to be pushed to\r\n        vm.channels = {\r\n            online: [],\r\n            offline: []\r\n        }\r\n        // init values\r\n        vm.service = menuService;\r\n\r\n\r\n        const promises = getTwitchData.async();\r\n\r\n        let P = $q.all(promises).then( response => {\r\n\r\n            response.map( obj => {\r\n            // if error\r\n            if (obj.data.error) {return obj.data.message}\r\n            // destructure object\r\n            const { data, data: {stream} } = obj;\r\n            // if online\r\n            if (stream) {\r\n                const { channel } = stream,\r\n                { display_name:name, game , status } = channel,\r\n                 parsedInfo = setDataOnline(stream);\r\n                 vm.channels.online.push(parsedInfo);\r\n              } else {\r\n                // if offline\r\n                const {_links:{channel:url}} = data;\r\n                getTwitchData.getChannel(url)\r\n                    .then( data => {\r\n                        // send data into function to be parsed and set to card\r\n                        const parsedInfo = setDataOffline(data.data);\r\n                        vm.channels.offline.push(parsedInfo);\r\n                        console.log('loading finished');\r\n                    });\r\n                }\r\n            });\r\n        });\r\n\r\n        /*\r\n         * data manipulation parese response json object\r\n         */\r\n        function setDataOffline(data) {\r\n            // channel object later used for ng repeat\r\n            let ci = SetDataBoth(data);\r\n            ci.live = false;\r\n            ci.game = 'Offline';\r\n            ci.frontAction = 'Go to channel';\r\n            return ci;\r\n        }\r\n        $scope.live = true;\r\n        function setDataOnline(stream) {\r\n            // channel object later used for ng repeat\r\n            const { channel, live, game, viewers, preview:{large:large} } = stream;\r\n\r\n            let ci = SetDataBoth(channel);\r\n\r\n            ci.live = true;\r\n            ci.game = game;\r\n            ci.viewers = abbreviateNumber(viewers);\r\n            ci.previewImg = large;\r\n            ci.strmDscr = concatDscr(status);\r\n            ci.frontAction = 'Watch Now';\r\n            return ci;\r\n        }\r\n        function SetDataBoth(channel){\r\n            // channel object later used for ng repeat\r\n            const { display_name:name, followers, url, status } = channel;\r\n            // construct object using const variables above\r\n            return {\r\n                name,\r\n                followers: abbreviateNumber(followers),\r\n                url,\r\n                status: concatDscr(status)\r\n            };\r\n        }\r\n        function setCardView(onlineBool, offlineBool){\r\n            // ng show true or false for both\r\n            vm.showOnline = onlineBool;\r\n            vm.showOffline = offlineBool;\r\n        }\r\n\r\n        /*\r\n         * further manipulate certain data...\r\n         */\r\n\r\n        function abbreviateNumber(value) {\r\n            var newValue = value.toString();\r\n\r\n            if (value >= 1000){\r\n\r\n                if ( value < 1000000 ){\r\n                    return `${Math.floor(newValue / 1000)} k`;\r\n                }\r\n                else {\r\n                    let n = newValue / 1000000;\r\n                    let s = n.toString();\r\n                    n = `${s.slice(0, s.indexOf('.')+2)}m`;\r\n                    if(n.slice(2,-1) === '0'){\r\n                        return `${n.slice(0,1)}m`;\r\n                    } else return n;\r\n                }\r\n            }\r\n            return newValue;\r\n        }\r\n\r\n        function concatDscr(str) {\r\n            return  `${str.slice(0,30)} ...`;\r\n        }\r\n\r\n    }\r\n})()\r\n"]}